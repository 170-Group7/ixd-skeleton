/*! @name videojs-hls-stream-selector @version 0.1.0 @license MIT */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],e):(t=t||self).videojsHlsStreamSelector=e(t.videojs)}(this,function(t){"use strict";function e(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var n=function(t){function n(e,n){var r,i=n.id,o=n.bandwidth,a=i;return o&&(a=parseFloat((o/1e6).toFixed(1))+" mbps"),(r=t.call(this,e,{label:a,selectable:!0,selected:!1})||this).id=i,r.bandwidth=o,r}return e(n,t),n.prototype.handleClick=function(){this.player().hlsStreamSelector().setState({currentItemId:this.id})},n}((t=t&&t.hasOwnProperty("default")?t.default:t).getComponent("MenuItem")),r=function(t){function r(e){var n;return(n=t.call(this,e,{title:"Quality"})||this).controlText("Quality"),n.addClass("vjs-hls-stream-selector-button"),n.$(".vjs-icon-placeholder").classList.add("vjs-icon-cog"),n.setCurrentItem("auto"),n.player().hlsStreamSelector().on("statechanged",function(t){var e=t.changes;e&&e.currentItemId&&n.setCurrentItem(e.currentItemId.to)}),n}e(r,t);var i=r.prototype;return i.createItems=function(){var t=this,e=this.player().tech({IWillNotUseThisInPlugins:!0}).vhs.representations(),r=e.filter(function(t,n){var r=t.bandwidth;return e.findIndex(function(t){return t.bandwidth===r})===n}).map(function(e){var r=e.id,i=e.bandwidth;return new n(t.player(),{id:r,bandwidth:i})}).sort(function(t,e){return e.bandwidth-t.bandwidth});return r.length>1&&r.push(new n(this.player(),{id:"auto"})),r},i.setCurrentItem=function(t){this.items.forEach(function(e){return e.selected(e.id===t)}),this.player().tech({IWillNotUseThisInPlugins:!0}).vhs.representations().forEach(function(e){return e.enabled("auto"===t||e.id===t)})},r}(t.getComponent("MenuButton")),i=t.getPlugin("plugin"),o={},a=function(n){function i(e,i){var a;return(a=n.call(this,e)||this).options=t.mergeOptions(o,i),a.player.on("loadedmetadata",function(){a.player.tech({IWillNotUseThisInPlugins:!0}).vhs&&(a.player.addClass("vjs-hls-stream-selector"),a.player.controlBar.addChild(new r(a.player),{},a.player.controlBar.children().length-2))}),a}return e(i,n),i}(i);return a.defaultState={},a.VERSION="0.1.0",t.registerPlugin("hlsStreamSelector",a),a});
